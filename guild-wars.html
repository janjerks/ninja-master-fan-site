<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guild War Results & Rewards - Ninja Master Fan Site</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <nav>
        <a href="index.html">Home</a>
        <a href="https://play.google.com/store/apps/details?id=com.BitEasyInteractive.NinjaMaster" target="_blank">Play</a>
        <a href="https://www.facebook.com/profile.php?id=100083121342903" target="_blank">News</a>
        <a href="https://www.facebook.com/groups/ninjamasterashinobisaga" target="_blank">Community</a>
        <a href="guild-wars.html">Guild War Results and Rewards</a>
        <a href="https://nm-kekkai-solver.netlify.app/" target="_blank">Kekkai Solver and Simulator</a>
        <a href="https://nm-stats-simulator.vercel.app/" target="_blank">Stats Simulator</a>
        <a href="https://ninjamaster.rpg-board.net/f3-guides" target="_blank">Guides</a>
        <a href="https://ninjamaster.rpg-board.net/" target="_blank">Forum</a>
        <a href="https://ninjamaster.rpg-board.net/f5-support-questions" target="_blank">Support</a>
    </nav>

    <div class="hero">
        <h1>Guild War Results & Rewards</h1>
        <p>Historical guild rankings, winners, and rewards. Select a season to load details.</p>
    </div>

    <div class="container">
        <div class="section">
            <h2>Select Season</h2>
            <select id="seasonSelect" onchange="loadSeason()">
                <option value="">-- Choose a Season --</option>
                <option value="1">Season 1</option>
                <option value="2">Season 2</option>
                <!-- Add more here later -->
            </select>

            <div id="seasonContent" style="margin-top: 2rem; min-height: 400px;">
                <p id="placeholder">Select a season to view rankings, winners, and rewards.</p>
            </div>
        </div>
    </div>

    <footer>
        <p>Fan-made site for Ninja Master: A Shinobi Saga | Not official | Â© 2026 John</p>
    </footer>

    <script>
        async function loadSeason() {
            const select = document.getElementById('seasonSelect');
            const contentDiv = document.getElementById('seasonContent');
            const placeholder = document.getElementById('placeholder');
            const season = select.value;

            if (!season) {
                placeholder.style.display = 'block';
                contentDiv.innerHTML = '';
                return;
            }

            placeholder.style.display = 'none';
            contentDiv.innerHTML = '<p style="color: #ffcc00;">Loading Season ' + season + '...</p>';

            try {
                // Very aggressive cache busting: timestamp + random
                const cacheBuster = Date.now() + Math.random();
                console.log(`Fetching season ${season} with cache-buster: ${cacheBuster}`);

                const response = await fetch(`seasons/season${season}.html?cb=${cacheBuster}`, {
                    cache: 'no-store',          // Tell browser: do NOT cache this
                    headers: {
                        'Cache-Control': 'no-cache, no-store, must-revalidate',
                        'Pragma': 'no-cache',
                        'Expires': '0'
                    }
                });

                if (!response.ok) {
                    throw new Error(`HTTP error! Status: ${response.status}`);
                }

                const html = await response.text();
                console.log(`Fetched content for season ${season} (length: ${html.length} chars)`);

                // Small delay + force update
                setTimeout(() => {
                    contentDiv.innerHTML = html;
                    console.log(`Content updated for season ${season}`);
                }, 100);  // tiny delay helps some browsers re-render

            } catch (error) {
                console.error('Fetch error:', error);
                contentDiv.innerHTML = `<p style="color: #ff6347;">Error loading Season ${season}: ${error.message}.<br>Check console (F12) for details.</p>`;
            }
        }

        // Optional: auto-load first season on page open
        window.addEventListener('load', () => {
            document.getElementById('seasonSelect').value = '1';
            loadSeason();
        });
    </script>
</body>
</html>
